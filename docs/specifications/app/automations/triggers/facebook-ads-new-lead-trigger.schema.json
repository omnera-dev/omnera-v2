{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "New Lead",
  "description": "Triggered when a new Facebook Lead Ad response is created",
  "type": "object",
  "properties": {
    "account": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "string"
        }
      ],
      "x-user-stories": [
        "GIVEN user configures account WHEN validating input THEN value should meet schema requirements",
        "GIVEN account is set WHEN processing configuration THEN value should be used correctly"
      ]
    },
    "service": {
      "type": "string",
      "const": "facebook-ads",
      "x-business-rules": [
        "Fixed value (facebook-ads) identifies this specific root.definitions.automation_trigger.anyOf.3.anyOf.3.anyOf.0.properties.service type in discriminated unions and routing logic"
      ],
      "x-user-stories": [
        "GIVEN entity with service='facebook-ads' WHEN processing configuration THEN correct handler should be selected",
        "GIVEN invalid service value WHEN validating configuration THEN clear error message should identify the issue"
      ]
    },
    "event": {
      "type": "string",
      "const": "new-lead",
      "x-business-rules": [
        "Fixed value (new-lead) identifies this specific root.definitions.automation_trigger.anyOf.3.anyOf.3.anyOf.0.properties.event type in discriminated unions and routing logic"
      ],
      "x-user-stories": [
        "GIVEN entity with event='new-lead' WHEN processing configuration THEN correct handler should be selected",
        "GIVEN invalid event value WHEN validating configuration THEN clear error message should identify the issue"
      ]
    },
    "params": {
      "type": "object",
      "properties": {
        "pageId": {
          "title": "Facebook Page ID",
          "description": "The ID of the Facebook page with lead forms",
          "type": "string",
          "x-business-rules": ["The ID of the Facebook page with lead forms"],
          "x-user-stories": [
            "GIVEN a new entity is created WHEN the system assigns an ID THEN it should be unique within the parent collection",
            "GIVEN an entity exists WHEN attempting to modify its ID THEN the system should prevent changes (read-only constraint)",
            "GIVEN a client requests an entity by ID WHEN the ID is valid THEN the entity should be retrieved successfully"
          ]
        },
        "appId": {
          "title": "Facebook App ID",
          "description": "Your Facebook App ID from the developer console",
          "type": "string",
          "x-business-rules": ["Your Facebook App ID from the developer console"],
          "x-user-stories": [
            "GIVEN a new entity is created WHEN the system assigns an ID THEN it should be unique within the parent collection",
            "GIVEN an entity exists WHEN attempting to modify its ID THEN the system should prevent changes (read-only constraint)",
            "GIVEN a client requests an entity by ID WHEN the ID is valid THEN the entity should be retrieved successfully"
          ]
        },
        "appSecret": {
          "title": "Facebook App Secret",
          "description": "Your Facebook App Secret from the developer console",
          "type": "string",
          "x-business-rules": ["Your Facebook App Secret from the developer console"],
          "x-user-stories": [
            "GIVEN user provides appSecret WHEN validating input THEN string value should be accepted",
            "GIVEN appSecret is empty string WHEN validating input THEN behavior should follow optional/required rules"
          ]
        },
        "verifyToken": {
          "title": "Webhook Verify Token",
          "description": "Security token for webhook verification (auto-generated if not provided)",
          "type": "string",
          "x-business-rules": [
            "System automatically generates webhook verify token to ensure consistency and prevent duplicate or invalid values"
          ],
          "x-user-stories": [
            "GIVEN user provides verifyToken WHEN validating input THEN string value should be accepted",
            "GIVEN verifyToken is empty string WHEN validating input THEN behavior should follow optional/required rules"
          ]
        }
      },
      "required": ["pageId", "appId", "appSecret"],
      "additionalProperties": false,
      "x-business-rules": [
        "Object structure groups related params properties for better organization and type-safe access"
      ],
      "x-user-stories": [
        "GIVEN user configures params WHEN validating input THEN value should meet schema requirements",
        "GIVEN params is set WHEN processing configuration THEN value should be used correctly"
      ]
    }
  },
  "required": ["account", "service", "event", "params"],
  "additionalProperties": false,
  "x-user-stories": [
    "GIVEN I am working with known test vectors WHEN I compute challengeResponse correctly THEN it should complete successfully",
    "GIVEN the application is running WHEN I set up LinkedIn new lead gen response trigger (creates subscription if none) THEN it should work correctly"
  ],
  "x-business-rules": [
    "Object structure groups related new lead properties for better organization and type-safe access"
  ]
}
