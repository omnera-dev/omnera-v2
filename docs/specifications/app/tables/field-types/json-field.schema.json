{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "JSON Field",
  "description": "Flexible JSON field for storing structured data objects. Accepts any valid JSON (objects, arrays, primitives). Optionally provide a JSON Schema for validation to enforce structure and types. Useful for storing configuration objects, API responses, flexible attributes, and dynamic data that doesn't fit rigid schema. Displays with syntax highlighting and formatting in UI. Can be queried using JSON path expressions.",
  "type": "object",
  "properties": {
    "id": {
      "$ref": "../../common/definitions.schema.json#/definitions/id",
      "x-user-stories": [
        "GIVEN a new entity is created WHEN the system assigns an ID THEN it should be unique within the parent collection",
        "GIVEN an entity exists WHEN attempting to modify its ID THEN the system should prevent changes (read-only constraint)",
        "GIVEN a client requests an entity by ID WHEN the ID is valid THEN the entity should be retrieved successfully"
      ]
    },
    "name": {
      "$ref": "../../common/definitions.schema.json#/definitions/name",
      "x-user-stories": [
        "GIVEN new field is created WHEN saving configuration THEN field name should follow database naming conventions",
        "GIVEN field with duplicate name WHEN validating table schema THEN error should prevent conflicts",
        "GIVEN field name is set WHEN querying data THEN field should be accessible by its name"
      ]
    },
    "required": {
      "type": "boolean",
      "default": false,
      "x-business-rules": [
        "Defaults to false when not specified, providing sensible fallback behavior without requiring explicit configuration"
      ],
      "x-user-stories": [
        "GIVEN required is true WHEN processing entity THEN corresponding behavior should be enforced",
        "GIVEN required is false (default: False) WHEN processing entity THEN corresponding behavior should not be enforced",
        "GIVEN configuration with required WHEN validating settings THEN boolean value should be accepted"
      ]
    },
    "type": {
      "type": "string",
      "const": "json",
      "x-business-rules": [
        "Fixed value (json) identifies this specific root.properties.tables.items.properties.fields.items.anyOf.27.properties.type type in discriminated unions and routing logic"
      ],
      "x-user-stories": [
        "GIVEN entity with type='json' WHEN processing configuration THEN correct handler should be selected",
        "GIVEN invalid type value WHEN validating configuration THEN clear error message should identify the issue"
      ]
    },
    "schema": {
      "type": "object",
      "description": "Optional JSON Schema to validate the data",
      "x-business-rules": [
        "Object structure groups related schema properties for better organization and type-safe access"
      ],
      "x-user-stories": [
        "GIVEN user configures schema WHEN validating input THEN value should meet schema requirements",
        "GIVEN schema is set WHEN processing configuration THEN value should be used correctly"
      ]
    }
  },
  "required": ["id", "name", "type"],
  "additionalProperties": false,
  "x-business-rules": [
    "Object structure groups related json field properties for better organization and type-safe access"
  ]
}
