{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Status Field",
  "description": "Workflow status with customizable options and colors",
  "type": "object",
  "properties": {
    "id": {
      "$ref": "../../common/definitions.schema.json#/definitions/id",
      "x-user-stories": [
        "GIVEN a new entity is created WHEN the system assigns an ID THEN it should be unique within the parent collection",
        "GIVEN an entity exists WHEN attempting to modify its ID THEN the system should prevent changes (read-only constraint)",
        "GIVEN a client requests an entity by ID WHEN the ID is valid THEN the entity should be retrieved successfully"
      ]
    },
    "name": {
      "$ref": "../../common/definitions.schema.json#/definitions/name",
      "x-user-stories": [
        "GIVEN new field is created WHEN saving configuration THEN field name should follow database naming conventions",
        "GIVEN field with duplicate name WHEN validating table schema THEN error should prevent conflicts",
        "GIVEN field name is set WHEN querying data THEN field should be accessible by its name"
      ]
    },
    "required": {
      "type": "boolean",
      "default": false,
      "x-business-rules": [
        "Defaults to false when not specified, providing sensible fallback behavior without requiring explicit configuration"
      ],
      "x-user-stories": [
        "GIVEN required is true WHEN processing entity THEN corresponding behavior should be enforced",
        "GIVEN required is false (default: False) WHEN processing entity THEN corresponding behavior should not be enforced",
        "GIVEN configuration with required WHEN validating settings THEN boolean value should be accepted"
      ]
    },
    "indexed": {
      "type": "boolean",
      "default": true,
      "x-business-rules": [
        "Defaults to true when not specified, providing sensible fallback behavior without requiring explicit configuration"
      ],
      "x-user-stories": [
        "GIVEN indexed is true WHEN processing entity THEN corresponding behavior should be enforced",
        "GIVEN indexed is false (default: True) WHEN processing entity THEN corresponding behavior should not be enforced",
        "GIVEN configuration with indexed WHEN validating settings THEN boolean value should be accepted"
      ]
    },
    "type": {
      "type": "string",
      "const": "status",
      "x-business-rules": [
        "Fixed value (status) identifies this specific root.properties.tables.items.properties.fields.items.anyOf.20.properties.type type in discriminated unions and routing logic"
      ],
      "x-user-stories": [
        "GIVEN entity with type='status' WHEN processing configuration THEN correct handler should be selected",
        "GIVEN invalid type value WHEN validating configuration THEN clear error message should identify the issue"
      ]
    },
    "options": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "value": {
            "type": "string",
            "minLength": 1,
            "x-user-stories": [
              "GIVEN user provides value with at least 1 characters WHEN validating input THEN value should be accepted",
              "GIVEN user provides value shorter than 1 chars WHEN validating input THEN error should require minimum length"
            ]
          },
          "color": {
            "type": "string",
            "pattern": "^#[0-9a-fA-F]{6}$",
            "description": "Hex color code for the status",
            "x-business-rules": [
              "Pattern constraint enforces data format consistency and error prevention, rejecting invalid formats before they cause system errors"
            ],
            "x-user-stories": [
              "GIVEN user provides color matching pattern WHEN validating input THEN value should be accepted",
              "GIVEN user provides color not matching pattern WHEN validating input THEN clear error message should explain format requirement",
              "GIVEN color is stored WHEN retrieved later THEN original format should be preserved"
            ]
          }
        },
        "required": ["value"],
        "x-business-rules": [
          "Object structure groups related items properties for better organization and type-safe access"
        ]
      },
      "minItems": 1,
      "x-business-rules": [
        "Array enables multiple options to be configured, supporting flexible workflows and batch operations"
      ],
      "x-user-stories": [
        "GIVEN user provides options with at least 1 items WHEN validating input THEN array should be accepted",
        "GIVEN user provides options with fewer than 1 items WHEN validating input THEN error should enforce minimum items"
      ]
    },
    "default": {
      "type": "string",
      "x-user-stories": [
        "GIVEN user provides default WHEN validating input THEN string value should be accepted",
        "GIVEN default is empty string WHEN validating input THEN behavior should follow optional/required rules"
      ]
    }
  },
  "required": ["id", "name", "type", "options"],
  "additionalProperties": false,
  "x-business-rules": [
    "Object structure groups related status field properties for better organization and type-safe access"
  ]
}
