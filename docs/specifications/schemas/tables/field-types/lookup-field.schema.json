{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Lookup Field",
  "description": "Display field values from related records through a relationship. Specify relationshipField (the relationship field in current table) and relatedField (the field to display from related table). Read-only field that automatically shows current value from linked record. Updates when related record changes. Useful for showing related data without duplicating storage (e.g., showing customer name in order, category name in product). More efficient than copying data.",
  "type": "object",
  "properties": {
    "id": {
      "$ref": "../../common/definitions.schema.json#/definitions/id",
      "x-user-stories": [
        "GIVEN a new entity is created WHEN the system assigns an ID THEN it should be unique within the parent collection",
        "GIVEN an entity exists WHEN attempting to modify its ID THEN the system should prevent changes (read-only constraint)",
        "GIVEN a client requests an entity by ID WHEN the ID is valid THEN the entity should be retrieved successfully"
      ]
    },
    "name": {
      "$ref": "../../common/definitions.schema.json#/definitions/name",
      "x-user-stories": [
        "GIVEN new field is created WHEN saving configuration THEN field name should follow database naming conventions",
        "GIVEN field with duplicate name WHEN validating table schema THEN error should prevent conflicts",
        "GIVEN field name is set WHEN querying data THEN field should be accessible by its name"
      ]
    },
    "type": {
      "type": "string",
      "const": "lookup",
      "x-business-rules": [
        "Fixed value (lookup) identifies this specific root.properties.tables.items.properties.fields.items.anyOf.11.properties.type type in discriminated unions and routing logic"
      ],
      "x-user-stories": [
        "GIVEN entity with type='lookup' WHEN processing configuration THEN correct handler should be selected",
        "GIVEN invalid type value WHEN validating configuration THEN clear error message should identify the issue"
      ]
    },
    "relationshipField": {
      "type": "string",
      "description": "Name of the relationship field to lookup from",
      "minLength": 1,
      "x-business-rules": ["Name of the relationship field to lookup from"],
      "x-user-stories": [
        "GIVEN user provides relationshipField with at least 1 characters WHEN validating input THEN value should be accepted",
        "GIVEN user provides relationshipField shorter than 1 chars WHEN validating input THEN error should require minimum length"
      ]
    },
    "relatedField": {
      "type": "string",
      "description": "Name of the field in the related table to display",
      "minLength": 1,
      "x-business-rules": ["Name of the field in the related table to display"],
      "x-user-stories": [
        "GIVEN user provides relatedField with at least 1 characters WHEN validating input THEN value should be accepted",
        "GIVEN user provides relatedField shorter than 1 chars WHEN validating input THEN error should require minimum length"
      ]
    }
  },
  "required": ["id", "name", "type", "relationshipField", "relatedField"],
  "additionalProperties": false,
  "x-business-rules": [
    "Lookup Field is immutable after creation to ensure data integrity and prevent accidental corruption"
  ]
}
