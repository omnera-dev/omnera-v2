{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Split Into Paths",
  "description": "Branch automation into multiple paths",
  "type": "object",
  "properties": {
    "name": {
      "type": "string"
    },
    "service": {
      "type": "string",
      "const": "filter"
    },
    "action": {
      "type": "string",
      "const": "split-into-paths"
    },
    "params": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "filter": {
            "$ref": "../../common/filter-condition.schema.json"
          },
          "actions": {
            "type": "array",
            "items": {
              "$ref": "../automations.schema.json#/definitions/automation_action"
            }
          }
        },
        "required": ["name", "filter", "actions"],
        "additionalProperties": false
      }
    }
  },
  "required": ["name", "service", "action", "params"],
  "additionalProperties": false,
  "specs": [
    {
      "id": "SPEC-001",
      "given": "the application is running",
      "when": "I run a split into paths paths action",
      "then": "it should work correctly"
    },
    {
      "id": "SPEC-002",
      "given": "I am working with 2 valid paths",
      "when": "I run a split into paths paths action",
      "then": "it should complete successfully"
    },
    {
      "id": "SPEC-003",
      "given": "the application is running",
      "when": "I run a split into paths paths action before another action",
      "then": "it should work correctly"
    },
    {
      "id": "SPEC-004",
      "given": "I am working with an error",
      "when": "I run a split into paths paths action",
      "then": "it should complete successfully"
    },
    {
      "id": "SPEC-005",
      "given": "user provides name",
      "when": "validating input",
      "then": "string value should be accepted"
    },
    {
      "id": "SPEC-006",
      "given": "name is empty string",
      "when": "validating input",
      "then": "behavior should follow optional/required rules"
    },
    {
      "id": "SPEC-007",
      "given": "entity with service='filter'",
      "when": "processing configuration",
      "then": "correct handler should be selected"
    },
    {
      "id": "SPEC-008",
      "given": "invalid service value",
      "when": "validating configuration",
      "then": "clear error message should identify the issue"
    },
    {
      "id": "SPEC-009",
      "given": "entity with action='split-into-paths'",
      "when": "processing configuration",
      "then": "correct handler should be selected"
    },
    {
      "id": "SPEC-010",
      "given": "invalid action value",
      "when": "validating configuration",
      "then": "clear error message should identify the issue"
    },
    {
      "id": "SPEC-011",
      "given": "user provides params array",
      "when": "validating input",
      "then": "items should be processed in order"
    },
    {
      "id": "SPEC-012",
      "given": "params array is empty",
      "when": "validating input",
      "then": "behavior should follow optional/required rules"
    },
    {
      "id": "SPEC-013",
      "given": "user provides name",
      "when": "validating input",
      "then": "string value should be accepted"
    },
    {
      "id": "SPEC-014",
      "given": "name is empty string",
      "when": "validating input",
      "then": "behavior should follow optional/required rules"
    },
    {
      "id": "SPEC-015",
      "given": "user configures filter",
      "when": "validating input",
      "then": "value should meet schema requirements"
    },
    {
      "id": "SPEC-016",
      "given": "filter is set",
      "when": "processing configuration",
      "then": "value should be used correctly"
    },
    {
      "id": "SPEC-017",
      "given": "user provides actions array",
      "when": "validating input",
      "then": "items should be processed in order"
    },
    {
      "id": "SPEC-018",
      "given": "actions array is empty",
      "when": "validating input",
      "then": "behavior should follow optional/required rules"
    }
  ],
  "$id": "filter-split-into-paths-action.schema.json"
}
