{
  "$id": "indexes.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Database Indexes",
  "description": "Custom database indexes for query optimization. Indexes improve query performance by creating efficient lookup structures for specified fields.",
  "type": "array",
  "default": [],
  "examples": [
    [
      {
        "name": "idx_user_email",
        "fields": [
          "email"
        ]
      },
      {
        "name": "idx_user_created",
        "fields": [
          "created_at"
        ],
        "unique": false
      }
    ]
  ],
  "items": {
    "type": "object",
    "properties": {
      "name": {
        "$ref": "./name/name.schema.json"
      },
      "fields": {
        "$ref": "./fields/fields.schema.json"
      },
      "unique": {
        "$ref": "./unique/unique.schema.json"
      }
    },
    "required": [
      "name",
      "fields"
    ],
    "additionalProperties": false
  },
  "specs": [
    {
      "id": "APP-TABLES-INDEXES-001",
      "given": "user provides indexes array",
      "when": "validating input",
      "then": "items should be processed in order"
    },
    {
      "id": "APP-TABLES-INDEXES-002",
      "given": "indexes array is empty",
      "when": "validating input",
      "then": "behavior should follow optional/required rules"
    },
    {
      "id": "APP-TABLES-INDEXES-UNIQUE-001",
      "given": "unique is true",
      "when": "processing entity",
      "then": "corresponding behavior should be enforced"
    },
    {
      "id": "APP-TABLES-INDEXES-UNIQUE-002",
      "given": "unique is false (default: False)",
      "when": "processing entity",
      "then": "corresponding behavior should not be enforced"
    },
    {
      "id": "APP-TABLES-INDEXES-UNIQUE-003",
      "given": "configuration with unique",
      "when": "validating settings",
      "then": "boolean value should be accepted"
    },
    {
      "id": "APP-TABLES-INDEXES-FIELDS-001",
      "given": "user provides fields with at least 1 items",
      "when": "validating input",
      "then": "array should be accepted"
    },
    {
      "id": "APP-TABLES-INDEXES-FIELDS-002",
      "given": "user provides fields with fewer than 1 items",
      "when": "validating input",
      "then": "error should enforce minimum items"
    },
    {
      "id": "APP-TABLES-INDEXES-NAME-001",
      "given": "user provides name matching pattern",
      "when": "validating input",
      "then": "value should be accepted"
    },
    {
      "id": "APP-TABLES-INDEXES-NAME-002",
      "given": "user provides name not matching pattern",
      "when": "validating input",
      "then": "clear error message should explain format requirement"
    },
    {
      "id": "APP-TABLES-INDEXES-NAME-003",
      "given": "name is stored",
      "when": "retrieved later",
      "then": "original format should be preserved"
    }
  ]
}
