{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "language-switcher.schema.json",
  "title": "Language Switcher Block",
  "description": "A reusable language switcher UI component that displays available languages from app.languages configuration",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "const": "language-switcher",
      "description": "Block identifier"
    },
    "type": {
      "type": "string",
      "const": "language-switcher",
      "description": "Component type for language switcher"
    },
    "props": {
      "type": "object",
      "required": [],
      "properties": {
        "variant": {
          "type": "string",
          "enum": ["dropdown", "inline", "tabs"],
          "default": "dropdown",
          "description": "Display variant for language switcher UI"
        },
        "showFlags": {
          "type": "boolean",
          "default": false,
          "description": "Show flag icons next to language labels"
        },
        "position": {
          "type": "string",
          "description": "Position on page where switcher should appear",
          "examples": ["top-right", "header", "footer", "sidebar"]
        }
      },
      "additionalProperties": false
    }
  },
  "required": ["name", "type"],
  "additionalProperties": false,
  "examples": [
    {
      "name": "language-switcher",
      "type": "language-switcher",
      "props": {
        "variant": "dropdown"
      }
    },
    {
      "name": "language-switcher",
      "type": "language-switcher",
      "props": {
        "variant": "inline",
        "showFlags": true
      }
    },
    {
      "name": "language-switcher",
      "type": "language-switcher",
      "props": {
        "variant": "tabs",
        "showFlags": true,
        "position": "header"
      }
    }
  ],
  "x-specs": [
    {
      "id": "APP-BLOCKS-LANGUAGE-SWITCHER-001",
      "given": "a language-switcher block with dropdown variant",
      "when": "variant is set to dropdown",
      "then": "it should render a dropdown menu with all supported languages",
      "validation": {
        "setup": {
          "block": {
            "name": "language-switcher",
            "type": "language-switcher",
            "props": {
              "variant": "dropdown"
            }
          }
        },
        "assertions": [
          "Block validates with dropdown variant",
          "Variant is one of: dropdown, inline, tabs",
          "Props are optional with sensible defaults"
        ]
      },
      "application": {
        "app": {
          "languages": {
            "supported": ["en", "fr", "es"]
          }
        },
        "blocks": [
          {
            "name": "language-switcher",
            "type": "language-switcher",
            "props": {
              "variant": "dropdown"
            }
          }
        ],
        "pages": [
          {
            "name": "Home",
            "path": "/",
            "sections": [
              {
                "block": "language-switcher",
                "vars": {}
              }
            ]
          }
        ],
        "expectedDOM": "<div data-testid=\"block-language-switcher\" class=\"language-switcher-dropdown\"><button>EN</button><ul class=\"dropdown-menu\"><li><a href=\"/en\">English</a></li><li><a href=\"/fr\">FranÃ§ais</a></li><li><a href=\"/es\">EspaÃ±ol</a></li></ul></div>",
        "assertions": [
          "Dropdown variant: Compact dropdown menu for 3+ languages",
          "Data source: Reads from app.languages.supported: ['en', 'fr', 'es']",
          "Current language button: 'EN' (active language)",
          "Dropdown menu: All 3 languages listed with localized labels",
          "Navigation: Each language links to language-specific URL (/en, /fr, /es)",
          "Default variant: dropdown used when variant prop specified"
        ]
      }
    },
    {
      "id": "APP-BLOCKS-LANGUAGE-SWITCHER-002",
      "given": "a language-switcher block with showFlags enabled",
      "when": "showFlags is set to true",
      "then": "it should display flag emojis next to language labels",
      "validation": {
        "setup": {
          "block": {
            "name": "language-switcher",
            "type": "language-switcher",
            "props": {
              "variant": "inline",
              "showFlags": true
            }
          }
        },
        "assertions": [
          "Block validates with showFlags enabled",
          "ShowFlags is a boolean prop",
          "Flags enhance visual recognition of languages"
        ]
      },
      "application": {
        "app": {
          "languages": {
            "supported": ["en", "fr"]
          }
        },
        "blocks": [
          {
            "name": "language-switcher",
            "type": "language-switcher",
            "props": {
              "variant": "inline",
              "showFlags": true
            }
          }
        ],
        "pages": [
          {
            "name": "About",
            "path": "/about",
            "sections": [
              {
                "block": "language-switcher",
                "vars": {}
              }
            ]
          }
        ],
        "expectedDOM": "<div data-testid=\"block-language-switcher\" class=\"language-switcher-inline\"><a href=\"/en\" class=\"active\">ðŸ‡¬ðŸ‡§ English</a><a href=\"/fr\">ðŸ‡«ðŸ‡· FranÃ§ais</a></div>",
        "assertions": [
          "Inline variant: Horizontal button list for 2-3 languages",
          "showFlags: true â†’ Flag emojis displayed (ðŸ‡¬ðŸ‡§, ðŸ‡«ðŸ‡·)",
          "Flag placement: Before language label ('ðŸ‡¬ðŸ‡§ English')",
          "Visual recognition: Flags help users identify languages quickly",
          "Current language: 'en' marked with 'active' class",
          "Inline layout: Both language links displayed side-by-side"
        ]
      }
    },
    {
      "id": "APP-BLOCKS-LANGUAGE-SWITCHER-003",
      "given": "a language-switcher block with minimal configuration",
      "when": "only required properties are provided",
      "then": "it should use default variant (dropdown) and no flags",
      "validation": {
        "setup": {
          "block": {
            "name": "language-switcher",
            "type": "language-switcher"
          }
        },
        "assertions": [
          "Block validates with minimal config",
          "Default variant: dropdown",
          "Default showFlags: false",
          "Props are entirely optional"
        ]
      },
      "application": {
        "app": {
          "languages": {
            "supported": ["en", "de", "ja"]
          }
        },
        "blocks": [
          {
            "name": "language-switcher",
            "type": "language-switcher"
          }
        ],
        "pages": [
          {
            "name": "Products",
            "path": "/products",
            "sections": [
              {
                "block": "language-switcher",
                "vars": {}
              }
            ]
          }
        ],
        "expectedDOM": "<div data-testid=\"block-language-switcher\" class=\"language-switcher-dropdown\"><button>EN</button><ul class=\"dropdown-menu\"><li><a href=\"/en\">English</a></li><li><a href=\"/de\">Deutsch</a></li><li><a href=\"/ja\">æ—¥æœ¬èªž</a></li></ul></div>",
        "assertions": [
          "Minimal configuration: Only name and type required",
          "Props omitted: No props object provided",
          "Default variant: 'dropdown' used automatically",
          "Default showFlags: false (no flag emojis displayed)",
          "Languages: All 3 from app.languages.supported rendered",
          "Sensible defaults: Works out-of-the-box with zero configuration"
        ]
      }
    },
    {
      "id": "APP-BLOCKS-LANGUAGE-SWITCHER-REGRESSION-001",
      "given": "complete application configuration with all features",
      "when": "user completes full workflow",
      "then": "user can complete full language-switcher workflow",
      "workflow": [
        {
          "step": 1,
          "action": "User defines languages configuration with 3 supported languages",
          "validation": "Languages config validates with default, fallback, and supported array",
          "expectedState": "Multi-language system configured (en-US, fr-FR, es-ES)"
        },
        {
          "step": 2,
          "action": "User creates language-switcher block with dropdown variant and flags enabled",
          "validation": "Block validates with variant='dropdown', showFlags=true, position='header'",
          "expectedState": "Reusable language-switcher block defined in blocks array"
        },
        {
          "step": 3,
          "action": "User adds language-switcher block to page header section",
          "validation": "Page sections array includes block reference to 'language-switcher'",
          "expectedState": "Language-switcher block referenced in page header"
        },
        {
          "step": 4,
          "action": "System renders language-switcher as dropdown with all languages and flags",
          "validation": "Dropdown button shows current language with flag, menu lists all 3 languages with flags",
          "expectedState": "Dropdown renders: <select> with 3 <option> elements (EN ðŸ‡ºðŸ‡¸, FR ðŸ‡«ðŸ‡·, ES ðŸ‡ªðŸ‡¸)"
        },
        {
          "step": 5,
          "action": "User selects new language from dropdown, page reloads with new language",
          "validation": "Language selection persists to localStorage, page URL updates with language prefix",
          "expectedState": "Page switches to selected language, all content re-renders in new language"
        }
      ],
      "application": {
        "completeExample": {
          "languages": {
            "default": "en-US",
            "fallback": "en-US",
            "supported": [
              {
                "code": "en-US",
                "label": "English",
                "direction": "ltr"
              },
              {
                "code": "fr-FR",
                "label": "FranÃ§ais",
                "direction": "ltr"
              },
              {
                "code": "es-ES",
                "label": "EspaÃ±ol",
                "direction": "ltr"
              }
            ],
            "detectBrowser": true,
            "persistSelection": true,
            "translations": {
              "en-US": {
                "nav.home": "Home",
                "nav.about": "About",
                "nav.contact": "Contact"
              },
              "fr-FR": {
                "nav.home": "Accueil",
                "nav.about": "Ã€ propos",
                "nav.contact": "Contact"
              },
              "es-ES": {
                "nav.home": "Inicio",
                "nav.about": "Acerca de",
                "nav.contact": "Contacto"
              }
            }
          },
          "blocks": [
            {
              "name": "language-switcher",
              "type": "language-switcher",
              "props": {
                "variant": "dropdown",
                "showFlags": true,
                "position": "header"
              }
            }
          ],
          "pages": [
            {
              "name": "Home",
              "path": "/",
              "meta": {
                "title": "$t:nav.home",
                "description": "Multi-language application homepage"
              },
              "sections": [
                {
                  "block": "language-switcher",
                  "vars": {}
                }
              ]
            }
          ]
        },
        "expectedDOM": "<header>\n  <nav>\n    <a href=\"/en/\" data-testid=\"nav-link-home\">Home</a>\n    <a href=\"/en/about\" data-testid=\"nav-link-about\">About</a>\n    <a href=\"/en/contact\" data-testid=\"nav-link-contact\">Contact</a>\n    <select data-testid=\"language-switcher\" class=\"language-switcher-dropdown\" aria-label=\"Select language\">\n      <option value=\"en-US\" selected data-testid=\"language-option-en-US\">ðŸ‡ºðŸ‡¸ English</option>\n      <option value=\"fr-FR\" data-testid=\"language-option-fr-FR\">ðŸ‡«ðŸ‡· FranÃ§ais</option>\n      <option value=\"es-ES\" data-testid=\"language-option-es-ES\">ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>\n    </select>\n  </nav>\n</header>",
        "assertions": [
          "Language-switcher block renders as <select> dropdown element",
          "Dropdown variant: Compact dropdown menu optimized for 3+ languages",
          "Each supported language appears as <option> element with code, name, and flag",
          "Flag emojis displayed (showFlags: true): ðŸ‡ºðŸ‡¸ English, ðŸ‡«ðŸ‡· FranÃ§ais, ðŸ‡ªðŸ‡¸ EspaÃ±ol",
          "Current language marked as 'selected' in dropdown (en-US by default)",
          "Data source: Reads languages from app.languages.supported configuration",
          "Position property controls placement: header, footer, sidebar, top-right",
          "Dropdown includes aria-label for screen reader accessibility",
          "Language selection triggers page reload with new language code in URL prefix (/en/, /fr/, /es/)",
          "Selection persists to localStorage for cross-session language preference",
          "Works seamlessly with language detection (detectBrowser: true) on first visit",
          "Alternative variants supported: inline (horizontal buttons), tabs (tab-style navigation)",
          "Inline variant better for 2-3 languages, tabs variant for 2-4 languages",
          "Integration with page meta: Title and description translations via $t: references",
          "Complete multi-language workflow: config â†’ block â†’ reference â†’ render â†’ switch"
        ]
      },
      "integrationPoints": [
        "Languages configuration: Reads from app.languages.supported array for available languages",
        "Language detection: Works with app.languages.detectBrowser for first-visit smart defaults",
        "Persistent selection: Uses app.languages.persistSelection + localStorage for session persistence",
        "Page meta integration: Localized page titles and descriptions via $t: translation references",
        "URL routing: Language prefix in URLs (/en/, /fr/, /es/) for SEO and bookmarking",
        "Translation system: Centralized translations dictionary with $t:key lookup mechanism",
        "Navigation links: All nav links update with current language prefix on switch",
        "SEO meta tags: HTML lang attribute, hreflang alternate links, og:locale tags",
        "Accept-Language header: Browser language detection for initial language selection",
        "Block system: Reusable component defined once in blocks array, referenced in pages",
        "Props customization: Variant, showFlags, position props for flexible display options",
        "Accessibility: aria-label, semantic HTML, keyboard navigation support"
      ]
    }
  ],
  "x-usage-notes": {
    "dataSource": "This block reads available languages from app.languages.supported configuration",
    "integration": "Requires app.languages to be configured with at least one supported language",
    "behavior": "When user selects a language, it updates the current language context and triggers re-render with new translations",
    "variants": {
      "dropdown": "Compact dropdown menu (good for 3+ languages)",
      "inline": "Horizontal list of buttons (good for 2-3 languages)",
      "tabs": "Tab-style navigation (good for 2-4 languages)"
    }
  }
}
