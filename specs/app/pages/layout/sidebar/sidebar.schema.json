{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "sidebar.schema.json",
  "title": "Sidebar Configuration",
  "description": "Sidebar navigation and content configuration",
  "type": "object",
  "properties": {
    "enabled": {
      "type": "boolean",
      "default": false,
      "description": "Whether to show the sidebar"
    },
    "position": {
      "type": "string",
      "enum": ["left", "right"],
      "default": "left",
      "description": "Sidebar position"
    },
    "width": {
      "type": "string",
      "default": "256px",
      "description": "Sidebar width"
    },
    "collapsible": {
      "type": "boolean",
      "default": true,
      "description": "Whether sidebar can be collapsed"
    },
    "defaultCollapsed": {
      "type": "boolean",
      "default": false,
      "description": "Whether sidebar starts collapsed"
    },
    "sticky": {
      "type": "boolean",
      "default": true,
      "description": "Whether sidebar sticks on scroll"
    },
    "items": {
      "type": "array",
      "description": "Sidebar navigation items",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["link", "group", "divider"],
            "description": "Item type"
          },
          "label": {
            "type": "string",
            "description": "Item label"
          },
          "href": {
            "type": "string",
            "description": "Link destination"
          },
          "icon": {
            "type": "string",
            "description": "Item icon"
          },
          "children": {
            "type": "array",
            "description": "Nested items for groups",
            "items": {
              "$ref": "#/properties/items/items"
            }
          }
        },
        "required": ["type"]
      }
    }
  },
  "required": ["enabled"],
  "additionalProperties": false,
  "examples": [
    {
      "enabled": true,
      "position": "left",
      "width": "280px",
      "items": [
        {
          "type": "link",
          "label": "Dashboard",
          "href": "/dashboard",
          "icon": "home"
        },
        {
          "type": "group",
          "label": "Products",
          "icon": "package",
          "children": [
            {
              "type": "link",
              "label": "All Products",
              "href": "/products"
            },
            {
              "type": "link",
              "label": "Categories",
              "href": "/categories"
            }
          ]
        },
        {
          "type": "divider"
        },
        {
          "type": "link",
          "label": "Settings",
          "href": "/settings",
          "icon": "settings"
        }
      ]
    }
  ],
  "x-specs": [
    {
      "id": "APP-PAGES-SIDEBAR-001",
      "given": "a sidebar with enabled set to true",
      "when": "sidebar should be visible",
      "then": "it should display sidebar navigation",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "items": []
          }
        },
        "assertions": [
          "enabled: true (sidebar visible)",
          "Default: false (opt-in)",
          "Common for: docs, dashboards, admin panels"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "position": "left",
          "width": "256px",
          "items": [
            {
              "type": "link",
              "label": "Dashboard",
              "href": "/dashboard",
              "icon": "home"
            }
          ]
        },
        "expectedDOM": "<div data-testid=\"layout-container\" class=\"flex\"><aside data-testid=\"sidebar\" class=\"w-64 h-screen sticky top-0 bg-gray-50 border-r\"><nav class=\"p-4\"><a data-testid=\"sidebar-link-0\" href=\"/dashboard\" class=\"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100\"><svg class=\"w-5 h-5\"><!-- home icon --></svg><span>Dashboard</span></a></nav></aside><main class=\"flex-1\"><!-- page content --></main></div>",
        "assertions": [
          "Sidebar visible on left side",
          "Common for: documentation sites (Docusaurus), dashboards (admin panels)",
          "Persistent navigation across pages",
          "Use case: 5+ pages needing navigation"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-002",
      "given": "a sidebar with position 'left'",
      "when": "position is 'left' (default)",
      "then": "it should render sidebar on left side",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "position": "left"
          }
        },
        "assertions": [
          "position: enum ['left', 'right']",
          "Default: 'left'",
          "Most common: left (90% of sites)"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "position": "left",
          "width": "256px",
          "items": [
            {
              "type": "link",
              "label": "Docs",
              "href": "/docs"
            }
          ]
        },
        "expectedDOM": "<div class=\"flex\"><aside data-testid=\"sidebar-left\" class=\"w-64 order-first\"><!-- sidebar content --></aside><main class=\"flex-1\"><!-- main content --></main></div>",
        "assertions": [
          "Sidebar on left (order-first)",
          "Reading direction: left-to-right languages",
          "Most common pattern (90% of websites)",
          "Examples: GitHub, Notion, Linear"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-003",
      "given": "a sidebar with position 'right'",
      "when": "position is 'right'",
      "then": "it should render sidebar on right side",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "position": "right"
          }
        },
        "assertions": [
          "position: 'right'",
          "Less common (10% of sites)",
          "Use case: table of contents, metadata"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "position": "right",
          "width": "256px",
          "items": [
            {
              "type": "link",
              "label": "Table of Contents",
              "href": "#toc"
            }
          ]
        },
        "expectedDOM": "<div class=\"flex\"><main class=\"flex-1\"><!-- main content --></main><aside data-testid=\"sidebar-right\" class=\"w-64 order-last\"><!-- sidebar content --></aside></div>",
        "assertions": [
          "Sidebar on right (order-last)",
          "Use cases: table of contents (docs), metadata (product details)",
          "Less common than left (10% vs 90%)",
          "Examples: Medium (TOC), Amazon (product filters)"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-004",
      "given": "a sidebar with custom width",
      "when": "width is '280px'",
      "then": "it should apply custom sidebar width",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "width": "280px"
          }
        },
        "assertions": ["width: string (CSS value)", "Default: '256px' (16rem)", "Common: 200-320px"]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "width": "320px",
          "items": []
        },
        "expectedDOM": "<aside data-testid=\"sidebar\" class=\"sticky top-0 h-screen\" style=\"width: 320px;\"><!-- sidebar content --></aside>",
        "widthGuidelines": {
          "narrow": "200-240px (minimal, icon-focused)",
          "medium": "256-280px (default, balanced)",
          "wide": "300-320px (content-rich, nested groups)"
        },
        "assertions": [
          "Custom width: 320px (wide sidebar)",
          "Common widths: 256px (default), 280px, 320px",
          "Wider sidebars: more content, nested navigation",
          "Narrower sidebars: icon-focused, minimal text"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-005",
      "given": "a collapsible sidebar",
      "when": "collapsible is true (default)",
      "then": "it should allow users to collapse/expand sidebar",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "collapsible": true
          }
        },
        "assertions": [
          "collapsible: boolean (default: true)",
          "Toggle button to collapse/expand",
          "Saves state in localStorage"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "collapsible": true,
          "width": "256px",
          "items": [
            {
              "type": "link",
              "label": "Dashboard",
              "href": "/dashboard"
            }
          ]
        },
        "expectedDOM": {
          "expanded": "<aside data-testid=\"sidebar\" class=\"w-64 transition-all\"><button data-testid=\"sidebar-toggle\" class=\"absolute top-4 right-4\" aria-label=\"Collapse sidebar\">←</button><nav class=\"p-4\"><!-- navigation items --></nav></aside>",
          "collapsed": "<aside data-testid=\"sidebar\" class=\"w-16 transition-all\"><button data-testid=\"sidebar-toggle\" class=\"p-4\" aria-label=\"Expand sidebar\">→</button><nav class=\"p-2\"><!-- icons only --></nav></aside>"
        },
        "userAction": "User clicks collapse button",
        "behavior": {
          "collapse": "Sidebar width: 256px → 64px (icons only)",
          "localStorage": "Set 'sidebar-collapsed': 'true'",
          "persistence": "State persists across page loads"
        },
        "assertions": [
          "Toggle button collapses/expands sidebar",
          "Collapsed: icons only (64px width)",
          "Expanded: full navigation (256px width)",
          "localStorage persistence",
          "Common for: dashboards (more content space)"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-006",
      "given": "a sidebar defaulting to collapsed",
      "when": "defaultCollapsed is true",
      "then": "it should start in collapsed state",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "collapsible": true,
            "defaultCollapsed": true
          }
        },
        "assertions": [
          "defaultCollapsed: boolean (default: false)",
          "Requires collapsible: true",
          "Initial state: collapsed"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "collapsible": true,
          "defaultCollapsed": true,
          "width": "256px",
          "items": [
            {
              "type": "link",
              "label": "Dashboard",
              "href": "/dashboard",
              "icon": "home"
            }
          ]
        },
        "expectedDOM": "<aside data-testid=\"sidebar\" class=\"w-16\" data-collapsed=\"true\"><button data-testid=\"sidebar-toggle\" aria-label=\"Expand sidebar\">→</button><nav><a href=\"/dashboard\" title=\"Dashboard\"><svg class=\"w-6 h-6\"><!-- home icon --></svg></a></nav></aside>",
        "assertions": [
          "Sidebar starts collapsed (64px width)",
          "Icons visible, labels hidden",
          "User can expand if needed",
          "Use case: maximize content space by default"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-007",
      "given": "a sticky sidebar",
      "when": "sticky is true (default)",
      "then": "it should stick during page scroll",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "sticky": true
          }
        },
        "assertions": [
          "sticky: boolean (default: true)",
          "CSS: position: sticky, top: 0",
          "Sidebar visible during scroll"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "sticky": true,
          "position": "left",
          "width": "256px",
          "items": [
            {
              "type": "link",
              "label": "Section 1",
              "href": "#section1"
            },
            {
              "type": "link",
              "label": "Section 2",
              "href": "#section2"
            }
          ]
        },
        "expectedDOM": "<aside data-testid=\"sidebar\" class=\"sticky top-0 h-screen overflow-y-auto\"><nav><!-- navigation items --></nav></aside>",
        "behavior": {
          "scroll": "Sidebar stays fixed at top (position: sticky)",
          "overflow": "Sidebar scrollable if content exceeds viewport height",
          "visibility": "Always visible during page scroll"
        },
        "assertions": [
          "Sticky sidebar remains visible during scroll",
          "Common pattern: docs sites (always accessible navigation)",
          "overflow-y-auto: scrollable if too many items",
          "Best practice: true for navigation (accessibility)"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-008",
      "given": "a sidebar with link item",
      "when": "item type is 'link' with label, href, icon",
      "then": "it should render clickable sidebar link",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "items": [
              {
                "type": "link",
                "label": "Dashboard",
                "href": "/dashboard",
                "icon": "home"
              }
            ]
          }
        },
        "assertions": [
          "type: 'link'",
          "label + href required for links",
          "icon: optional (icon name string)"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "items": [
            {
              "type": "link",
              "label": "Dashboard",
              "href": "/dashboard",
              "icon": "home"
            },
            {
              "type": "link",
              "label": "Analytics",
              "href": "/analytics",
              "icon": "chart"
            },
            {
              "type": "link",
              "label": "Settings",
              "href": "/settings",
              "icon": "settings"
            }
          ]
        },
        "expectedDOM": "<aside data-testid=\"sidebar\"><nav><a data-testid=\"sidebar-link-0\" href=\"/dashboard\" class=\"flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-100 active:bg-blue-50\"><svg class=\"w-5 h-5\"><!-- home icon --></svg><span>Dashboard</span></a><a data-testid=\"sidebar-link-1\" href=\"/analytics\" class=\"flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-100\"><svg class=\"w-5 h-5\"><!-- chart icon --></svg><span>Analytics</span></a><a data-testid=\"sidebar-link-2\" href=\"/settings\" class=\"flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-100\"><svg class=\"w-5 h-5\"><!-- settings icon --></svg><span>Settings</span></a></nav></aside>",
        "assertions": [
          "Link items: icon + label",
          "Hover state: bg-gray-100",
          "Active page: bg-blue-50 (highlighted)",
          "Common pattern: icon-first, label-second"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-009",
      "given": "a sidebar with group item",
      "when": "item type is 'group' with label and children",
      "then": "it should render collapsible group with nested items",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "items": [
              {
                "type": "group",
                "label": "Products",
                "icon": "package",
                "children": [
                  {
                    "type": "link",
                    "label": "All Products",
                    "href": "/products"
                  },
                  {
                    "type": "link",
                    "label": "Categories",
                    "href": "/categories"
                  }
                ]
              }
            ]
          }
        },
        "assertions": [
          "type: 'group'",
          "label required, icon optional",
          "children: array of nested items",
          "Collapsible (expand/collapse)"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "items": [
            {
              "type": "group",
              "label": "Products",
              "icon": "package",
              "children": [
                {
                  "type": "link",
                  "label": "All Products",
                  "href": "/products"
                },
                {
                  "type": "link",
                  "label": "Add Product",
                  "href": "/products/new"
                }
              ]
            },
            {
              "type": "group",
              "label": "Analytics",
              "icon": "chart",
              "children": [
                {
                  "type": "link",
                  "label": "Overview",
                  "href": "/analytics"
                },
                {
                  "type": "link",
                  "label": "Reports",
                  "href": "/analytics/reports"
                }
              ]
            }
          ]
        },
        "expectedDOM": {
          "collapsed": "<aside data-testid=\"sidebar\"><nav><button data-testid=\"sidebar-group-0\" class=\"flex items-center justify-between w-full px-3 py-2 rounded hover:bg-gray-100\"><div class=\"flex items-center gap-3\"><svg class=\"w-5 h-5\"><!-- package icon --></svg><span>Products</span></div><svg class=\"w-4 h-4 transform rotate-0\"><!-- chevron right --></svg></button></nav></aside>",
          "expanded": "<aside data-testid=\"sidebar\"><nav><button data-testid=\"sidebar-group-0\" class=\"flex items-center justify-between w-full px-3 py-2 rounded bg-gray-100\"><div class=\"flex items-center gap-3\"><svg class=\"w-5 h-5\"><!-- package icon --></svg><span>Products</span></div><svg class=\"w-4 h-4 transform rotate-90\"><!-- chevron down --></svg></button><div data-testid=\"sidebar-group-0-children\" class=\"ml-8 mt-1 space-y-1\"><a href=\"/products\" class=\"block px-3 py-2 text-sm rounded hover:bg-gray-100\">All Products</a><a href=\"/products/new\" class=\"block px-3 py-2 text-sm rounded hover:bg-gray-100\">Add Product</a></div></nav></aside>"
        },
        "userAction": "User clicks 'Products' group",
        "behavior": {
          "click": "Toggle expand/collapse",
          "chevron": "Rotate 0° → 90° (visual feedback)",
          "children": "Show/hide nested items with slide animation"
        },
        "assertions": [
          "Groups are collapsible (expand/collapse)",
          "Chevron icon indicates state (→ collapsed, ↓ expanded)",
          "Nested items indented (ml-8)",
          "Common for: categorized navigation (Products → All, Add, etc.)"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-010",
      "given": "a sidebar with divider item",
      "when": "item type is 'divider'",
      "then": "it should render visual separator between sections",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "items": [
              {
                "type": "link",
                "label": "Dashboard",
                "href": "/dashboard"
              },
              {
                "type": "divider"
              },
              {
                "type": "link",
                "label": "Settings",
                "href": "/settings"
              }
            ]
          }
        },
        "assertions": ["type: 'divider'", "No label, href, or children", "Visual separator only"]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "items": [
            {
              "type": "link",
              "label": "Dashboard",
              "href": "/dashboard",
              "icon": "home"
            },
            {
              "type": "link",
              "label": "Analytics",
              "href": "/analytics",
              "icon": "chart"
            },
            {
              "type": "divider"
            },
            {
              "type": "link",
              "label": "Settings",
              "href": "/settings",
              "icon": "settings"
            },
            {
              "type": "link",
              "label": "Logout",
              "href": "/logout",
              "icon": "logout"
            }
          ]
        },
        "expectedDOM": "<aside data-testid=\"sidebar\"><nav class=\"space-y-1\"><a href=\"/dashboard\">Dashboard</a><a href=\"/analytics\">Analytics</a><hr data-testid=\"sidebar-divider\" class=\"my-4 border-t border-gray-200\" /><a href=\"/settings\">Settings</a><a href=\"/logout\">Logout</a></nav></aside>",
        "assertions": [
          "Divider: horizontal line (border-gray-200)",
          "Separates logical sections (main navigation vs settings)",
          "Common pattern: primary actions above, secondary below",
          "Examples: Dashboard/Analytics (main) | Settings/Logout (account)"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-011",
      "given": "a sidebar with recursive children",
      "when": "groups can contain nested groups or links",
      "then": "it should support unlimited nesting for sidebar hierarchy",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "items": [
              {
                "type": "group",
                "label": "Products",
                "children": [
                  {
                    "type": "group",
                    "label": "Electronics",
                    "children": [
                      {
                        "type": "link",
                        "label": "Phones",
                        "href": "/products/electronics/phones"
                      },
                      {
                        "type": "link",
                        "label": "Laptops",
                        "href": "/products/electronics/laptops"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        },
        "assertions": [
          "Recursive: groups can contain groups",
          "$ref: #/properties/items/items (self-reference)",
          "Unlimited nesting depth"
        ]
      },
      "application": {
        "sidebar": {
          "enabled": true,
          "items": [
            {
              "type": "group",
              "label": "Docs",
              "children": [
                {
                  "type": "group",
                  "label": "Getting Started",
                  "children": [
                    {
                      "type": "link",
                      "label": "Installation",
                      "href": "/docs/installation"
                    },
                    {
                      "type": "link",
                      "label": "Quick Start",
                      "href": "/docs/quick-start"
                    }
                  ]
                },
                {
                  "type": "group",
                  "label": "API Reference",
                  "children": [
                    {
                      "type": "group",
                      "label": "REST API",
                      "children": [
                        {
                          "type": "link",
                          "label": "Authentication",
                          "href": "/docs/api/auth"
                        },
                        {
                          "type": "link",
                          "label": "Endpoints",
                          "href": "/docs/api/endpoints"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "expectedDOM": "<aside data-testid=\"sidebar\"><nav><div data-testid=\"sidebar-group-0\" class=\"mb-2\"><button class=\"font-semibold\">Docs</button><div class=\"ml-4 mt-1\"><button class=\"text-sm\">Getting Started</button><div class=\"ml-4 mt-1\"><a href=\"/docs/installation\" class=\"text-sm\">Installation</a><a href=\"/docs/quick-start\" class=\"text-sm\">Quick Start</a></div><button class=\"text-sm mt-2\">API Reference</button><div class=\"ml-4 mt-1\"><button class=\"text-sm\">REST API</button><div class=\"ml-4 mt-1\"><a href=\"/docs/api/auth\" class=\"text-sm\">Authentication</a><a href=\"/docs/api/endpoints\" class=\"text-sm\">Endpoints</a></div></div></div></div></nav></aside>",
        "hierarchy": {
          "level1": "Docs (group)",
          "level2": "Getting Started, API Reference (groups)",
          "level3": "Installation, Quick Start | REST API (links + group)",
          "level4": "Authentication, Endpoints (links)"
        },
        "assertions": [
          "Unlimited nesting: groups within groups",
          "Each level indented (ml-4)",
          "Common for: documentation (hierarchical content)",
          "Examples: Docusaurus, Nextra (3-4 levels deep)"
        ]
      }
    },
    {
      "id": "APP-PAGES-SIDEBAR-012",
      "given": "a sidebar for docs/dashboard layouts",
      "when": "sidebar provides persistent navigation",
      "then": "it should enable documentation and admin-style layouts",
      "validation": {
        "setup": {
          "sidebar": {
            "enabled": true,
            "sticky": true,
            "collapsible": true,
            "items": []
          }
        },
        "assertions": [
          "Common patterns: docs sites, dashboards, admin panels",
          "Persistent navigation across pages",
          "sticky + collapsible = optimal UX"
        ]
      },
      "application": {
        "useCases": {
          "documentation": {
            "example": "Docusaurus, Nextra, GitBook",
            "pattern": "Hierarchical groups (3-4 levels), sticky sidebar, collapsible",
            "items": "Docs sections → Categories → Pages"
          },
          "dashboard": {
            "example": "Linear, Notion, Retool",
            "pattern": "Flat links + few groups, collapsible, icons",
            "items": "Dashboard, Analytics, Settings, etc."
          },
          "adminPanel": {
            "example": "Stripe Dashboard, AWS Console",
            "pattern": "Many groups (products/services), sticky, wide (280-320px)",
            "items": "Products, Billing, Users, Settings, etc."
          }
        },
        "assertions": [
          "3 main use cases: docs, dashboards, admin panels",
          "Docs: hierarchical (3-4 levels), many groups",
          "Dashboards: flat, icon-focused, collapsible",
          "Admin: wide (280-320px), many top-level groups",
          "All: sticky + collapsible for optimal UX"
        ]
      }
    },
    {
      "id": "APP-PAGES-LAYOUT-SIDEBAR-REGRESSION-001",
      "given": "complete application configuration with all features",
      "when": "user completes full workflow",
      "then": "user can complete full sidebar workflow"
    }
  ]
}
